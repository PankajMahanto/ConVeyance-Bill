<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conveyance Bill Tracker (Final Version)</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load jsPDF and jsPDF-AutoTable for PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>

    <!-- Moved styles to external file (no changes in content) -->
    <link rel="stylesheet" href="./assets/css/styles.css">
</head>

<body class="bg-gray-100 p-2 md:p-8">

    <div class="max-w-6xl mx-auto bg-white rounded-lg shadow-xl overflow-hidden">

        <!-- Header -->
        <div class="p-4 md:p-6 bg-blue-600">
            <h1 class="text-xl md:text-2xl font-bold text-white">Conveyance Bill Tracker</h1>
            <p class="text-xs text-blue-200 mt-1">Data automatically saves in your browser.</p>
        </div>

        <!-- Company Name Input -->
        <div class="p-4 md:p-6 border-b border-gray-200 bg-blue-50">
            <label for="company-name" class="block text-sm font-medium text-gray-700">Company Name</label>
            <input type="text" id="company-name" name="company-name" placeholder="Enter your company name for reports"
                class="mt-1 block w-full md:w-1/2 rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
        </div>

        <!-- Input Form -->
        <form id="bill-form"
            class="p-4 md:p-6 border-b border-gray-200 grid grid-cols-2 md:grid-cols-6 gap-3 md:gap-4 items-end">
            <!-- Day Field -->
            <div class="col-span-1">
                <label for="day" class="block text-sm font-medium text-gray-700">Day</label>
                <input type="date" id="day" name="day"
                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"
                    required>
            </div>
            <!-- Time Field (Optional) -->
            <div class="col-span-1">
                <label for="time" class="block text-sm font-medium text-gray-700">Time (Opt.)</label>
                <input type="time" id="time" name="time"
                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
            </div>
            <!-- Item / From Field (Optional) -->
            <div class="col-span-1">
                <label for="from" class="block text-sm font-medium text-gray-700">Item / From</label>
                <input type="text" id="from" name="from" placeholder="e.g., Home, Lunch"
                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
            </div>
            <!-- Vendor / To Field (Optional) -->
            <div class="col-span-1">
                <label for="to" class="block text-sm font-medium text-gray-700">Vendor / To</label>
                <input type="text" id="to" name="to" placeholder="e.g., Office, Canteen"
                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
            </div>
            <!-- Category / Transport Field -->
            <div class="col-span-1">
                <label for="transport" class="block text-sm font-medium text-gray-700">Category</label>
                <input type="text" id="transport" name="transport" placeholder="e.g., Bus, Food"
                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"
                    required>
            </div>
            <!-- Amount Field -->
            <div class="col-span-1">
                <label for="amount" class="block text-sm font-medium text-gray-700">Amount (Tk.)</label>
                <input type="number" id="amount" name="amount" min="0" step="0.01" placeholder="0.00"
                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"
                    required>
            </div>
            <button type="submit"
                class="col-span-2 md:col-span-6 w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-md shadow transition duration-150 ease-in-out">
                Add Bill Entry
            </button>
        </form>

        <!-- Download Buttons (Responsive Stack) -->
        <div class="p-4 bg-gray-50 border-b border-gray-200 flex flex-col sm:flex-row gap-2 justify-end">
            <button id="finalize-day"
                class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-md shadow text-sm transition duration-150">
                Finalize & Save Day's Report
            </button>
            <button id="download-csv"
                class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-md shadow text-sm transition duration-150">
                Download All (CSV)
            </button>
            <button id="download-pdf"
                class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-md shadow text-sm transition duration-150">
                Download All (PDF)
            </button>
        </div>

        <!-- Bill Table (Wrapped for Horizontal Scroll on Mobile) -->
        <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-gray-100">
                    <tr>
                        <th scope="col"
                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider min-w-[110px]">
                            Day</th>
                        <th scope="col"
                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider min-w-[90px]">
                            Time</th>
                        <th scope="col"
                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider min-w-[100px]">
                            Item / From</th>
                        <th scope="col"
                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider min-w-[100px]">
                            Vendor / To</th>
                        <th scope="col"
                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider min-w-[100px]">
                            Category</th>
                        <th scope="col"
                            class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider min-w-[100px]">
                            Amount</th>
                        <th scope="col"
                            class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider min-w-[100px]">
                            Action</th>
                    </tr>
                </thead>
                <tbody id="bill-table-body" class="bg-white divide-y divide-gray-200">
                    <!-- Rows will be dynamically inserted here by JavaScript -->
                </tbody>
                <tfoot class="bg-gray-200">
                    <tr>
                        <td colspan="5"
                            class="px-6 py-4 whitespace-nowrap text-right text-sm font-bold text-gray-700 uppercase">
                            Total</td>
                        <td id="total-amount"
                            class="px-6 py-4 whitespace-nowrap text-right text-sm font-bold text-gray-900">0.00</td>
                        <td class="px-6 py-4"></td>
                    </tr>
                </tfoot>
            </table>
        </div>

        <!-- Finalized Reports Section -->
        <div class="p-4 md:p-6 border-t border-gray-200">
            <h2 class="text-lg font-semibold text-gray-800 mb-4">Finalized Daily Reports</h2>
            <div id="finalized-reports-list" class="divide-y divide-gray-200">
                <p class="text-sm text-gray-500" id="no-reports-message">No reports finalized yet.</p>
            </div>
        </div>

    </div>

    <!-- Enhanced Modal for Alerts/Messages -->
    <div id="app-modal"
        class="custom-modal hidden fixed inset-0 overflow-y-auto h-full w-full z-50 flex items-center justify-center p-4">
        <div class="modal-content bg-white w-full max-w-sm mx-auto rounded-xl shadow-2xl p-6">
            <div class="flex justify-between items-start mb-4">
                <div class="flex items-center">
                    <span id="modal-icon" class="mr-3 flex-shrink-0"></span>
                    <h3 id="modal-title" class="text-xl font-bold text-gray-900">Message</h3>
                </div>
                <button id="modal-close-btn"
                    class="text-gray-400 hover:text-gray-600 transition-colors duration-200 p-1 rounded-full hover:bg-gray-100"
                    title="Close" aria-label="Close dialog">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20" aria-hidden="true">
                        <path fill-rule="evenodd"
                            d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                            clip-rule="evenodd" />
                    </svg>
                </button>
            </div>
            <div id="modal-body" class="modal-body text-gray-600 mt-2 max-h-[60vh] overflow-y-auto">
                <p>An unexpected error occurred.</p>
            </div>
            <div class="mt-6 flex justify-end space-x-3">
                <button id="modal-cancel-btn"
                    class="hidden px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors duration-200">
                    Cancel
                </button>
                <button id="modal-confirm-btn"
                    class="px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors duration-200">
                    OK
                </button>
            </div>
        </div>
    </div>

    <!-- Edit Bill Modal -->
    <div id="edit-bill-modal"
        class="custom-modal hidden fixed inset-0 overflow-y-auto h-full w-full z-50 flex items-center justify-center p-4">
        <div class="modal-content bg-white w-full max-w-lg mx-auto rounded-xl shadow-2xl p-6">
            <div class="flex justify-between items-start mb-6">
                <h3 class="text-xl font-bold text-gray-900">Edit Bill Entry</h3>
                <button id="edit-modal-close-btn"
                    class="text-gray-400 hover:text-gray-600 transition-colors duration-200 p-1 rounded-full hover:bg-gray-100"
                    title="Close" aria-label="Close edit dialog">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20" aria-hidden="true">
                        <path fill-rule="evenodd"
                            d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                            clip-rule="evenodd" />
                    </svg>
                </button>
            </div>
            <form id="edit-bill-form" class="space-y-4">
                <input type="hidden" id="edit-bill-id">
                <div class="grid grid-cols-2 gap-4">
                    <div class="col-span-1">
                        <label for="edit-day" class="block text-sm font-medium text-gray-700 mb-1">Day</label>
                        <input type="date" id="edit-day" required
                            class="w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                    </div>
                    <div class="col-span-1">
                        <label for="edit-time" class="block text-sm font-medium text-gray-700 mb-1">Time
                            (Optional)</label>
                        <input type="time" id="edit-time"
                            class="w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                    </div>
                    <div class="col-span-1">
                        <label for="edit-from" class="block text-sm font-medium text-gray-700 mb-1">Item / From</label>
                        <input type="text" id="edit-from" placeholder="e.g., Home, Lunch"
                            class="w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                    </div>
                    <div class="col-span-1">
                        <label for="edit-to" class="block text-sm font-medium text-gray-700 mb-1">Vendor / To</label>
                        <input type="text" id="edit-to" placeholder="e.g., Office, Canteen"
                            class="w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                    </div>
                    <div class="col-span-1">
                        <label for="edit-transport"
                            class="block text-sm font-medium text-gray-700 mb-1">Category</label>
                        <input type="text" id="edit-transport" placeholder="e.g., Bus, Food" required
                            class="w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                    </div>
                    <div class="col-span-1">
                        <label for="edit-amount" class="block text-sm font-medium text-gray-700 mb-1">Amount
                            (Tk.)</label>
                        <input type="number" id="edit-amount" min="0" step="0.01" placeholder="0.00" required
                            class="w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                    </div>
                </div>
                <div class="flex justify-end space-x-3 mt-6 pt-4 border">
                    <button type="button" id="edit-bill-cancel"
                        class="px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors duration-200">
                        Cancel
                    </button>
                    <button type="submit"
                        class="px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors duration-200">
                        Save Changes
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Report Details Modal -->
    <div id="report-details-modal"
        class="custom-modal hidden fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50 flex items-center justify-center p-4">
        <div
            class="bg-white w-full max-w-2xl mx-auto rounded-xl shadow-2xl overflow-hidden transform scale-100 transition duration-300">
            <div class="flex justify-between items-start p-4 md:p-6 border-b border-gray-200 bg-gray-50">
                <div>
                    <h3 id="report-modal-title" class="text-xl font-bold text-gray-800">Report Details</h3>
                    <p id="report-modal-subtitle" class="mt-1 text-sm text-gray-600"></p>
                </div>
                <button id="report-modal-close-btn"
                    class="text-gray-400 hover:text-gray-600 transition-colors duration-200 p-1 rounded-full hover:bg-gray-200"
                    title="Close" aria-label="Close report details">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20" aria-hidden="true">
                        <path fill-rule="evenodd"
                            d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                            clip-rule="evenodd" />
                    </svg>
                </button>
            </div>
            <div id="report-modal-body" class="p-4 md:p-6 max-h-[70vh] overflow-y-auto"></div>
        </div>
    </div>

    <!-- Moved JavaScript to external file (no changes in content) -->
    <script src="./assets/js/app.js"></script>
</body>

</html>
